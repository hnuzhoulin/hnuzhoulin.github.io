---
title: 一次硬盘被重新分区并写入数据后的整体恢复
date: 2015/11/21 23:39:50
updated: 2015/11/21 23:39:50
categories: linux
tags: [排错]
description: 一次硬盘被重新分区并写入数据后的整体恢复
---
## 1.前请提要
新买了一个SanDisk的3.0的U盘，于是换系统到**移动硬盘**里的win8.1进行测试，测试完成后就开始制作**多系统启动U盘**，使用大白菜制作，由于自定义了背景字体等，于是跟常规制作方式不一样，弹出了一个类似**UltraISO**的制作框，于是没多看没多想，点了制作隐藏分区，勾选格式化，悲催就在这里，默认选择的是我的移动硬盘，等到提示说是使用中时才发现，惨剧已经酿成。只能先把多系统启动盘做完再说，后面的没什么问题。

但是在重启后查看移动银盘发现，**500G的空间被分割成一个470M的隐藏分区，剩余空间为未分区状态**。

**``实际分区：``**

* /dev/sdb1      主分区  60G    Ext4  LinuxMint17.1
* /dev/sdb2      主分区  350G  Ext4  Linux Home data
* /dev/sdb3      主分区  40G     NTFS  win8.1 
* /dev/sdb3       HPFS/NTFS/exFAT
* /dev/sdb4       扩展分区  50G
* /dev/sdb5       主分区  50G    Ext4  LinuxMint17

## 2.解决过程
想到的第一种解决方法是尝试**``恢复分区``**，毕竟只有前面的470M写入数据，后面的理论上是没有发生变化的。

**``由于手边没有大容量硬盘先将恢复硬盘拷贝一份，于是本着尽量不对硬盘做任何有可能改变其数据的原则进行下面的工作。``**

### 2.1 DiskGenius恢复分区表
由于大白菜的win2003PE进不去，进入系统也是加载失败，于是换Win8PE，默认就加载了**``DiskGenius``**，这个也是最熟悉的，于是乎最先使用它搜索移动硬盘。

最先找到的是我安装有LinuxMint17的Ext4主分区，这个没什么问题，但是接下来的事情就很诡异了，连续很多次提示找到100M的FAT，500M的NTFS等等，搜索速度还是可以的，只是个把小时了，搜索也将近80%，依然没有找到我最像保留的**``sdb2分区``**，于是放弃。

### 2.2 分区助手恢复
于是又在PE里面盘工具，找到了另一个分区工具**``分区助手``**，找找发现确实也有恢复分区表功能，又是一段时间的检索，一开始我还是很兴奋的，因为没找多久就提示我找到了如上所述的sdb1和sdb3，只是很快就提示找了很多歌Ext4分区，不靠谱啊，果断又终止了。

### 2.3 DiskGenius恢复文件
这个工具还可以实现文件恢复，对于数据依然还在硬盘上这一点我是很清楚很肯定的，因此在分区表找回不顺畅的情况下，很自然的想到的就是数据恢复。

在经过漫漫等待后，（其实是看了部电影）回来看我擦擦，居然定格在55%不动了，苍天不开眼啊，想着55%应该也能恢复不少数据，先停止看看都有哪些，坑爹的是停止也等了很长时间也没反应，整个电脑卡了，无奈重启。

### 2.4 FinalData恢复
再次进入PE后点击加载更多工具，就能够使用**``FinalData``**了，这个恢复还是满强悍的，只是速度不咋地，用它恢复貌似默认也还是会先搜分区表，短暂扫描它居然找到了现成的470M分区和40G安装有win8.1的主分区，然后一小会时间文件树就出来了，简单看看文件都在，但是**其他被删分区的文件居然一点也没有**，我觉得很奇怪，同时瞬间泪奔啊，找不到分区就没法恢复，这还有天理吗？但同时也有一个比较疯的想法，(至少在我的知识储备里面当时觉得是死马当活马医)：**``不破不立``**。

既然只能搜找到分区的文件，那么我和不干脆将**现有的分区表干掉，整个盘建分区再恢复**？数据肯定还是会在的。

就在我尝试使用前面的工具DG删除分区的时候，居然提示我已经挂载请先卸载，无奈这个 win下面已经挂在的分区不会卸载啊。于是又用**``分区助手``**来试一试，于是乎使用它强行将移动硬盘的所有分区删除了，就在我准备新建分区时，有看到了寻找分区表的菜单，我想**``会不会是现有的分区表导致DG恢复分区表的时候出错``**，既然现在分区表已经删掉了，何不在新建前再试一次？

### 2.5 删除现有分区后再用分区助手找回分区
这时，奇迹出现了，才几秒钟分区助手就全部将上述提到的分区都找到了，立马选择回写。

然后重启，这次是进入我的笔记本SSD的LinuxDeepin系统，经过简单检查发现分区表没问题，主要文件也没有问题，尝试重启进入移动硬盘win8.1的时候报错了，可能是MBR需要修复下也有可能最初写的470M将某部分文件覆盖了，这个无所谓，关键的350G的数据分区在，另外两个LinuxMint，17.1的进入正常，17的因为原本升级内核的时候出了点问题，进不去桌面，这次直接就是无法正常启动，fsck过后，卡在某一点不动了，这也无所谓。

## 3. 总结

1. 一开始定的原则是没错的：尽量不对硬盘有任何写操作
2. 优选分区恢复
3. 其次数据还原
4. 现有分区会影响分区恢复软件的搜索结果，需要先将所有分区表去掉
5. 最好**``备份分区表``**